# ãƒã‚°ä¿®æ­£ - ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—æ¤œå‡ºã®æ”¹å–„

## ğŸ› ç™ºè¦‹ã•ã‚ŒãŸãƒã‚°

### ç—‡çŠ¶

ZZZï¼ˆã‚¼ãƒ³ãƒ¬ã‚¹ã‚¾ãƒ¼ãƒ³ã‚¼ãƒ­ï¼‰ã‚’å¤–éƒ¨â†’å†…è”µã«åˆ‡ã‚Šæ›¿ãˆãŸå¾Œã€ã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒˆã•ã‚Œã¦ã„ã‚‹ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ã¾ã ã€ŒğŸ”Œ å¤–éƒ¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã€ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹ã€‚

### åŸå› 

`get_storage_type()` é–¢æ•°ã®åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ãŒä¸æ­£ç¢ºã§ã—ãŸï¼š

**å•é¡Œç‚¹:**
1. `Solid State: Yes` ã ã‘ã§ã¯å†…è”µ/å¤–éƒ¨ã‚’åˆ¤å®šã§ããªã„
   - å¤–ä»˜ã‘SSDã‚‚ `Solid State: Yes` ã«ãªã‚‹
2. APFSãƒœãƒªãƒ¥ãƒ¼ãƒ ã¨ã—ã¦ãƒã‚¦ãƒ³ãƒˆã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¦ã„ãªã„
   - å†…è”µã«ã‚³ãƒ”ãƒ¼å¾Œã‚‚ãƒœãƒªãƒ¥ãƒ¼ãƒ ãŒãƒã‚¦ãƒ³ãƒˆã•ã‚Œã¦ã„ã‚Œã°å¤–éƒ¨ã¨åˆ¤å®šã™ã¹ã

---

## âœ… ä¿®æ­£å†…å®¹

### æ–°ã—ã„åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ï¼ˆå„ªå…ˆé †ä½é †ï¼‰

#### 1. ãƒã‚¦ãƒ³ãƒˆçŠ¶æ…‹ã®ç¢ºèªï¼ˆæœ€å„ªå…ˆï¼‰

```bash
# ãƒ‘ã‚¹ãŒAPFSãƒœãƒªãƒ¥ãƒ¼ãƒ ã¨ã—ã¦ãƒã‚¦ãƒ³ãƒˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
local mount_check=$(/sbin/mount | /usr/bin/grep " on ${path} ")
if [[ -n "$mount_check" ]] && [[ "$mount_check" =~ "apfs" ]]; then
    echo "external"  # ãƒã‚¦ãƒ³ãƒˆã•ã‚ŒãŸAPFSãƒœãƒªãƒ¥ãƒ¼ãƒ  = å¤–éƒ¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
    return
fi
```

**ç†ç”±:**
- `~/Library/Containers/{bundle_id}` ãŒç‹¬ç«‹ã—ãŸAPFSãƒœãƒªãƒ¥ãƒ¼ãƒ ã¨ã—ã¦ãƒã‚¦ãƒ³ãƒˆã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãã‚Œã¯å¤–éƒ¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ãƒœãƒªãƒ¥ãƒ¼ãƒ 
- å†…è”µã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚³ãƒ”ãƒ¼ã—ãŸå ´åˆã€é€šå¸¸ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãªã‚‹ã®ã§ãƒã‚¦ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒˆã§ã¯ãªã„

#### 2. Device Location ã®ç¢ºèª

```bash
local disk_location=$(diskutil info "/dev/$disk_id" 2>/dev/null | \
    /usr/bin/grep "Device Location:" | \
    /usr/bin/awk -F: '{print $2}' | \
    /usr/bin/sed 's/^ *//')

if [[ "$disk_location" == "Internal" ]]; then
    echo "internal"
elif [[ "$disk_location" == "External" ]]; then
    echo "external"
```

**ç†ç”±:**
- `Device Location` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæœ€ã‚‚ä¿¡é ¼ã§ãã‚‹æƒ…å ±æº
- "Internal" ã¾ãŸã¯ "External" ã‚’æ˜ç¤ºçš„ã«ç¤ºã™

#### 3. ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯åˆ¤å®š

```bash
# disk0 ã¾ãŸã¯ disk1 ã¯é€šå¸¸å†…è”µãƒ‡ã‚£ã‚¹ã‚¯
if [[ "$disk_id" == "disk0" ]] || [[ "$disk_id" == "disk1" ]]; then
    echo "internal"
else
    echo "external"
fi
```

**ç†ç”±:**
- macOSã§ã¯é€šå¸¸ã€disk0ãŒå†…è”µãƒ‡ã‚£ã‚¹ã‚¯
- disk1ã¯Fusion Driveã®å ´åˆãªã©ã«ä½¿ç”¨ã•ã‚Œã‚‹
- disk2ä»¥é™ã¯å¤–éƒ¨ãƒ‡ã‚£ã‚¹ã‚¯ã®å¯èƒ½æ€§ãŒé«˜ã„

---

## ğŸ“Š åˆ¤å®šä¾‹

### ã‚±ãƒ¼ã‚¹1: å¤–éƒ¨APFSãƒœãƒªãƒ¥ãƒ¼ãƒ ã«ãƒã‚¦ãƒ³ãƒˆ

```bash
ãƒ‘ã‚¹: ~/Library/Containers/com.HoYoverse.Nap
ãƒã‚¦ãƒ³ãƒˆçŠ¶æ…‹: /dev/disk5s1 on ~/Library/Containers/com.HoYoverse.Nap (apfs)

åˆ¤å®šçµæœ: external âœ…
ç†ç”±: APFSãƒœãƒªãƒ¥ãƒ¼ãƒ ã¨ã—ã¦ãƒã‚¦ãƒ³ãƒˆã•ã‚Œã¦ã„ã‚‹
```

### ã‚±ãƒ¼ã‚¹2: å†…è”µãƒ‡ã‚£ã‚¹ã‚¯ã®é€šå¸¸ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

```bash
ãƒ‘ã‚¹: ~/Library/Containers/com.HoYoverse.Nap
ãƒã‚¦ãƒ³ãƒˆçŠ¶æ…‹: ãƒã‚¦ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒˆã§ã¯ãªã„ï¼ˆé€šå¸¸ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰
ãƒ‡ãƒã‚¤ã‚¹: /dev/disk1s5 (ã‚·ã‚¹ãƒ†ãƒ ãƒ‡ã‚£ã‚¹ã‚¯)

åˆ¤å®šçµæœ: internal âœ…
ç†ç”±: ãƒã‚¦ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒˆã§ã¯ãªãã€disk1ï¼ˆå†…è”µï¼‰ä¸Šã«ã‚ã‚‹
```

### ã‚±ãƒ¼ã‚¹3: å¤–éƒ¨ãƒ‡ã‚£ã‚¹ã‚¯ã®é€šå¸¸ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆç¨€ï¼‰

```bash
ãƒ‘ã‚¹: /Volumes/ExternalDrive/SomeApp
ãƒ‡ãƒã‚¤ã‚¹: /dev/disk5
Device Location: External

åˆ¤å®šçµæœ: external âœ…
ç†ç”±: Device Location ãŒ External
```

---

## ğŸ” ä¿®æ­£å‰å¾Œã®æ¯”è¼ƒ

### ä¿®æ­£å‰ã®ãƒ­ã‚¸ãƒƒã‚¯

```bash
# å•é¡Œ: Solid State ã ã‘ã§åˆ¤å®šã—ã¦ã„ãŸ
local is_internal=$(diskutil info "/dev/$disk_id" | grep "Solid State:" | grep -i "yes")
local disk_type=$(diskutil info "/dev/$disk_id" | grep "Device Location:" | grep -i "internal")

if [[ -n "$is_internal" ]] || [[ -n "$disk_type" ]]; then
    echo "internal"
else
    echo "external"
fi
```

**å•é¡Œç‚¹:**
- å¤–ä»˜ã‘SSDã‚‚ `Solid State: Yes` ã«ãªã‚‹
- ãƒã‚¦ãƒ³ãƒˆçŠ¶æ…‹ã‚’è€ƒæ…®ã—ã¦ã„ãªã„
- åˆ¤å®šãŒæ›–æ˜§

### ä¿®æ­£å¾Œã®ãƒ­ã‚¸ãƒƒã‚¯

```bash
# 1. ã¾ãšãƒã‚¦ãƒ³ãƒˆçŠ¶æ…‹ã‚’ç¢ºèªï¼ˆæœ€å„ªå…ˆï¼‰
local mount_check=$(/sbin/mount | /usr/bin/grep " on ${path} ")
if [[ -n "$mount_check" ]] && [[ "$mount_check" =~ "apfs" ]]; then
    echo "external"
    return
fi

# 2. Device Location ã‚’ç¢ºèª
local disk_location=$(diskutil info "/dev/$disk_id" | grep "Device Location:" | ...)

if [[ "$disk_location" == "Internal" ]]; then
    echo "internal"
elif [[ "$disk_location" == "External" ]]; then
    echo "external"
else
    # 3. ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: disk ID ã§åˆ¤å®š
    if [[ "$disk_id" == "disk0" ]] || [[ "$disk_id" == "disk1" ]]; then
        echo "internal"
    else
        echo "external"
    fi
fi
```

**æ”¹å–„ç‚¹:**
- âœ… ãƒã‚¦ãƒ³ãƒˆçŠ¶æ…‹ã‚’å„ªå…ˆçš„ã«ç¢ºèª
- âœ… Device Location ã§æ˜ç¢ºã«åˆ¤å®š
- âœ… ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯åˆ¤å®šã‚’è¿½åŠ 
- âœ… ã‚ˆã‚Šæ­£ç¢ºãªåˆ¤å®š

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

### ãƒ†ã‚¹ãƒˆ1: å¤–éƒ¨ãƒœãƒªãƒ¥ãƒ¼ãƒ ãƒã‚¦ãƒ³ãƒˆçŠ¶æ…‹

```bash
# çŠ¶æ…‹
/dev/disk5s1 on ~/Library/Containers/com.HoYoverse.Nap (apfs, local, nodev, nosuid, journaled, noowners, nobrowse)

# æœŸå¾…ã•ã‚Œã‚‹çµæœ
ğŸ”Œ å¤–éƒ¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
```

### ãƒ†ã‚¹ãƒˆ2: å†…è”µã«åˆ‡ã‚Šæ›¿ãˆå¾Œï¼ˆãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒˆï¼‰

```bash
# çŠ¶æ…‹
~/Library/Containers/com.HoYoverse.Nap ã¯é€šå¸¸ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
/dev/disk1s5 on / (apfs, sealed, local, read-only, journaled)

# æœŸå¾…ã•ã‚Œã‚‹çµæœ
ğŸ’¾ å†…è”µã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
```

### ãƒ†ã‚¹ãƒˆ3: å†…è”µâ†’å¤–éƒ¨ã«åˆ‡ã‚Šæ›¿ãˆå¾Œ

```bash
# çŠ¶æ…‹
/dev/disk5s2 on ~/Library/Containers/com.HoYoverse.Nap (apfs, local, nodev, nosuid, journaled, noowners, nobrowse)

# æœŸå¾…ã•ã‚Œã‚‹çµæœ
ğŸ”Œ å¤–éƒ¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
```

---

## ğŸ’¡ ãªãœã“ã®æ–¹æ³•ãŒæ­£ç¢ºãªã®ã‹ï¼Ÿ

### ãƒã‚¦ãƒ³ãƒˆçŠ¶æ…‹ãŒæœ€å„ªå…ˆã§ã‚ã‚‹ç†ç”±

1. **æ˜ç¢ºãªåŒºåˆ¥**
   - ãƒã‚¦ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒˆ = ç‹¬ç«‹ã—ãŸãƒœãƒªãƒ¥ãƒ¼ãƒ  = å¤–éƒ¨ç®¡ç†
   - é€šå¸¸ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª = ã‚·ã‚¹ãƒ†ãƒ ãƒ‡ã‚£ã‚¹ã‚¯ã®ä¸€éƒ¨ = å†…è”µ

2. **PlayCoverã®ä½¿ç”¨æ–¹æ³•ã«åˆè‡´**
   - å¤–éƒ¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: APFSãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’ãƒã‚¦ãƒ³ãƒˆ
   - å†…è”µã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: é€šå¸¸ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

3. **åˆ‡ã‚Šæ›¿ãˆå¾Œã®çŠ¶æ…‹ã‚’æ­£ç¢ºã«åæ˜ **
   - å¤–éƒ¨â†’å†…è”µ: ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒˆ â†’ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãªã‚‹ â†’ å†…è”µã¨åˆ¤å®š
   - å†…è”µâ†’å¤–éƒ¨: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå‰Šé™¤ â†’ ãƒœãƒªãƒ¥ãƒ¼ãƒ ãƒã‚¦ãƒ³ãƒˆ â†’ å¤–éƒ¨ã¨åˆ¤å®š

---

## ğŸ”§ ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

### ç¾åœ¨ã®çŠ¶æ…‹ã‚’ç¢ºèª

```bash
# ãƒã‚¦ãƒ³ãƒˆçŠ¶æ…‹ã‚’ç¢ºèª
mount | grep Containers

# å‡ºåŠ›ä¾‹ï¼ˆå¤–éƒ¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼‰:
/dev/disk5s1 on /Users/xxx/Library/Containers/com.HoYoverse.Nap (apfs, ...)

# å‡ºåŠ›ä¾‹ï¼ˆå†…è”µã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼‰:
# ï¼ˆä½•ã‚‚è¡¨ç¤ºã•ã‚Œãªã„ = ãƒã‚¦ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒˆã§ã¯ãªã„ï¼‰
```

### ãƒ‡ã‚£ã‚¹ã‚¯æƒ…å ±ã‚’ç¢ºèª

```bash
# ãƒ‡ãƒã‚¤ã‚¹ã‚’ç¢ºèª
df ~/Library/Containers/com.HoYoverse.Nap

# ãƒ‡ã‚£ã‚¹ã‚¯æƒ…å ±ã‚’ç¢ºèª
diskutil info /dev/disk5
```

### æ‰‹å‹•ã§ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—ã‚’åˆ¤å®š

```bash
# ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®é–¢æ•°ã‚’æ‰‹å‹•å®Ÿè¡Œ
path="$HOME/Library/Containers/com.HoYoverse.Nap"
mount | grep " on ${path} "

# å‡ºåŠ›ã‚ã‚Š â†’ å¤–éƒ¨
# å‡ºåŠ›ãªã— â†’ å†…è”µã®å¯èƒ½æ€§
```

---

## âœ… ä¿®æ­£å®Œäº†

### å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«

```
/home/user/webapp/2_playcover-volume-manager.command
```

### ä¿®æ­£ã•ã‚ŒãŸé–¢æ•°

```bash
get_storage_type()  # è¡Œ 264-306
```

### å¤‰æ›´å†…å®¹

- âœ… ãƒã‚¦ãƒ³ãƒˆçŠ¶æ…‹ã®ç¢ºèªã‚’æœ€å„ªå…ˆã«è¿½åŠ 
- âœ… Device Location ã®è§£æã‚’æ”¹å–„
- âœ… ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯åˆ¤å®šã‚’è¿½åŠ 
- âœ… ã‚ˆã‚Šæ­£ç¢ºã§ä¿¡é ¼æ€§ã®é«˜ã„åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å†èµ·å‹•**
   ```bash
   ./2_playcover-volume-manager.command
   ```

2. **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸çŠ¶æ…‹ã®ç¢ºèª**
   - ã‚ªãƒ—ã‚·ãƒ§ãƒ³ 6 ã‚’é¸æŠ
   - ã‚¢ãƒ—ãƒªä¸€è¦§ã§ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¢ã‚¤ã‚³ãƒ³ã‚’ç¢ºèª
   - å†…è”µã«åˆ‡ã‚Šæ›¿ãˆæ¸ˆã¿ãªã‚‰ğŸ’¾ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãš

3. **å¿…è¦ã«å¿œã˜ã¦å†åˆ‡ã‚Šæ›¿ãˆ**
   - ã¾ã ğŸ”ŒãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆã€å®Ÿéš›ã«ã¯ã¾ã å¤–éƒ¨ã«ã‚ã‚‹å¯èƒ½æ€§
   - ãã®å ´åˆã¯å†åº¦åˆ‡ã‚Šæ›¿ãˆã‚’å®Ÿè¡Œ

---

**ä¿®æ­£å®Œäº†ï¼å†ãƒ†ã‚¹ãƒˆã‚’ãŠé¡˜ã„ã—ã¾ã™ï¼** ğŸ‰

---

**ä¿®æ­£æ—¥**: 2025-01-XX  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v1.3.2  
**ä¿®æ­£è€…**: AI Assistant  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… ä¿®æ­£å®Œäº†ãƒ»æ¤œè¨¼å¾…ã¡
